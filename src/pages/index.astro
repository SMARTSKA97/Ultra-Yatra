---
import SiteLayout from "../layouts/SiteLayout.astro";
import { getCollection } from "astro:content";
import PostCard from "../components/PostCard.astro";

const posts = (await getCollection("posts"))
  .filter((p:any) => (p.data.status ?? "Published") === "Published")
  .sort((a:any,b:any) => new Date(String(b.data.publishedAt)).getTime() - new Date(String(a.data.publishedAt)).getTime())
  .slice(0, 9);
---
<SiteLayout>
  <section class="hero">
    <h1>Ultra Yatra</h1>
    <p>My ultracycling journey â€” stories, scars, stats, and soul. Long miles, honest lessons.</p>
  </section>

  <section>
    <h2 style="margin:0 0 1rem">Latest posts</h2>
    <div class="grid">
      {posts.map((p:any) => (
        <PostCard
          href={`/blog/${p.data.slug ?? p.slug}`}
          title={p.data.title}
          cover={p.data.cover}
          date={String(p.data.publishedAt)}
          language={p.data.language}
          excerpt={p.data.excerpt}
        />
      ))}
    </div>
  </section>
</SiteLayout>
